!function(){"use strict";function t(t,e){return Math.floor(Math.random()*(e-t+1))+t}function e(){window.deviceready||(window.deviceready=!0,new q)}var n=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,n,i)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(i)},s=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},a=function t(e,n,i,r){var s=Object.getOwnPropertyDescriptor(e,n);if(void 0===s){var o=Object.getPrototypeOf(e);null!==o&&t(o,n,i,r)}else if("value"in s&&s.writable)s.value=i;else{var a=s.set;void 0!==a&&a.call(r,i)}return i},u=function(){function t(e){n(this,t),this._node=e,this.addEventListener=this._node.addEventListener.bind(this._node),this._hiddenClass="control_hidden"}return i(t,[{key:"show",value:function(){this._node.classList.remove(this._hiddenClass)}},{key:"hide",value:function(){this._node.classList.add(this._hiddenClass)}},{key:"addToDOM",value:function(t){t.appendChild(this._node)}},{key:"remove",value:function(){this._node.remove()}}]),t}(),l=function(t){function e(t,i){n(this,e);var r=o(this,Object.getPrototypeOf(e).call(this,t));return r._defaultValue=i,r}return s(e,t),i(e,[{key:"dropValue",value:function(){this.value=this._defaultValue}},{key:"value",get:function(){return this._value},set:function(t){this._value=t}}]),e}(u),c=function(t){function e(t){n(this,e);var i=o(this,Object.getPrototypeOf(e).call(this,t,0));return i._countNode=i._node.querySelector(".control__count"),i}return s(e,t),i(e,[{key:"value",get:function(){return r(Object.getPrototypeOf(e.prototype),"value",this)},set:function(t){a(Object.getPrototypeOf(e.prototype),"value",t,this),this._countNode.innerHTML=t}}]),e}(l),h=3,d=function(t){function e(t){n(this,e);var i=o(this,Object.getPrototypeOf(e).call(this,t,h));i._starIcons=[];for(var r=0;r<i._defaultValue;r++){var s=document.createElement("div");s.classList.add("control__star-icon"),i._starIcons.push(s),i._node.appendChild(s)}return i}return s(e,t),i(e,[{key:"value",get:function(){return r(Object.getPrototypeOf(e.prototype),"value",this)},set:function(t){t=Math.min(this._defaultValue,t),a(Object.getPrototypeOf(e.prototype),"value",t,this);for(var n=0;n<this.value;n++)this._starIcons[n].style.opacity=1;for(var i=Math.max(this.value,0);i<this._defaultValue;i++)this._starIcons[i].style.opacity=0}}]),e}(l),_=function(t){function e(t){n(this,e);var i=o(this,Object.getPrototypeOf(e).call(this,t));return i.muteCallback=void 0,i._songName=t.querySelector(".control__text_song-name"),i._muteBtn=t.querySelector(".control__btn"),i._muteBtn.addEventListener("click",function(){i._muteBtn.classList.toggle("icon-volume-high"),i._muteBtn.classList.toggle("icon-volume-off"),i.muteCallback()}),i}return s(e,t),i(e,[{key:"updateSongName",value:function(t){this._songName.innerHTML=t}}]),e}(u),f=function(){function e(t,i,r){var s=arguments.length<=3||void 0===arguments[3]?1:arguments[3];n(this,e),this.r=t,this.g=i,this.b=r,this.a=s}return i(e,[{key:"toRGBString",value:function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"}},{key:"toRGBAString",value:function(){return"rgb("+this.r+", "+this.g+", "+this.b+", "+this.a+")"}}],[{key:"random",value:function(){var n=arguments.length<=0||void 0===arguments[0]?0:arguments[0],i=arguments.length<=1||void 0===arguments[1]?255:arguments[1],r=arguments.length<=2||void 0===arguments[2]?1:arguments[2];return new e(t(n,i),t(n,i),t(n,i),r)}}]),e}(),v=180,m=255,y=8,p=15,g=1e3,b=100*g,k=function(e){function a(e){var i=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];n(this,a);var r=o(this,Object.getPrototypeOf(a).call(this,e));if(i){var s=t(g,b);setTimeout(function(){e.classList.remove("control_blinking"),e.classList.add("control_blinking"),s=t(g,b)},s)}return r}return s(a,e),i(a,[{key:"hide",value:function(){r(Object.getPrototypeOf(a.prototype),"hide",this).call(this),this._node.classList.remove("control_blinking")}}],[{key:"generateRandom",value:function(){var e=document.createElement("div");e.classList.add("control_star"),e.classList.add("control_hidden");var n=t(y,p);e.style.width=e.style.height=n+"px",e.style.top=t(0,100)+"%",e.style.left=t(0,100)+"%";var i=[f.random(v,m),f.random(v,m),f.random(v,m,.9)];return e.style.background="radial-gradient(\n                ellipse at center, \n                "+i[0].toRGBString()+" 0%, \n                "+i[1].toRGBString()+" 50%, \n                "+i[2].toRGBString()+" 100%\n            )",e.style.boxShadow="0 0 "+3*n/2+"px "+i[2].toRGBAString(),new a(e,(!0))}}]),a}(u),S=function(t){function e(t){n(this,e);var i=o(this,Object.getPrototypeOf(e).call(this,t));return i._hiddenClass="menu__screen_inactive",i}return s(e,t),e}(u),w=function(t){function e(t){n(this,e);var i=o(this,Object.getPrototypeOf(e).call(this,t));return i.startGameBtn=i._node.querySelector(".menu__btn_start-game"),i}return s(e,t),e}(S),O=function(t){function e(t){n(this,e);var i=o(this,Object.getPrototypeOf(e).call(this,t));return i.retryBtn=i._node.querySelector(".menu__btn_retry"),i.shareBtn=i._node.querySelector(".menu__btn_share"),i._textScore=i._node.querySelector(".menu__text_score"),i._textPlural=i._node.querySelector(".menu__text_plural"),i}return s(e,t),i(e,[{key:"score",set:function(t){this._textScore.innerHTML=t,1==t?this._textPlural.style.display="none":this._textPlural.style.display="inline"}}]),e}(S),C=function(t){function e(t){n(this,e);var i=o(this,Object.getPrototypeOf(e).call(this,t));return i._hiddenClass="stars-holder_inactive",i}return s(e,t),i(e,[{key:"node",get:function(){return this._node}}]),e}(u),E="mp3/",x={newStar:["kastenfrosch__space.mp3","kastenfrosch__mysterious.mp3"],wrongStar:["kastenfrosch__passagierabsetzen.mp3"]},T=[{file:"Beluga_-_Lost_In_Outer_Space.mp3",name:"Beluga Ten - Lost In Outer Space"},{file:"Brendan_J._Boyd_-_Quiet_Space__ambient_mix_.mp3",name:"Brendan J. Boyd - Quiet Space (ambient mix)"},{file:"mika_-_Fall_to_pieces_-_Silence.mp3",name:"mika - Fall to pieces: Silence"},{file:"mixxim_-_Sentimental_Fields.mp3",name:"MIXXIM - Sentimental Fields"},{file:"morgantj_-_Time_Decay.mp3",name:"morgantj - Time Decay"},{file:"Tigoolio_-_Dance_of_space_jellyfish.mp3",name:"Tigoolio - Dance of space jellyfish"}],P={path:E,effects:x,music:T},j=function(){},L=function(){function e(t,i){var r=this;if(n(this,e),this._nextTrackCallback=i,this._sounds=t,this._mute=!1,this._lastEffectNumbers={},this._native=window.plugins&&window.plugins.NativeAudio,this._native){for(var s in t.effects)for(var o in t.effects[s]){var a=this._sounds.path+t.effects[s][o];window.plugins.NativeAudio.preloadSimple(a,a)}this._nativeMusicIds=[];var u=function(e){var n=r._sounds.path+t.music[e].file;window.plugins.NativeAudio.preloadComplex(n,n,1,1,0,function(){r._nativeMusicIds.push(n),r._trackLoadCallback()})};for(var l in t.music)u(l)}else this._players={},this._musicPlayer=new Audio,this._musicPlayer.addEventListener("ended",function(){return r._nextTrack()}),this._nextTrack();this._prevTrackNumber=-1}return i(e,[{key:"_trackLoadCallback",value:function(){this._nativeMusicIds.length===this._sounds.music.length&&this._nextTrack()}},{key:"_randomTrackNumber",value:function(){return t(0,this._sounds.music.length-1)}},{key:"_nextTrack",value:function(){var t=this,e=void 0;do e=this._randomTrackNumber();while(e===this._prevTrackNumber);var n=this._sounds.path+this._sounds.music[e].file;this._prevTrackNumber=e,this._native?window.plugins.NativeAudio.play(n,j,j,function(){t._nextTrack()}):(this._musicPlayer.src=n,this._musicPlayer.play()),this._nextTrackCallback(this._sounds.music[e].name)}},{key:"_playSound",value:function(t){var e=this;this._mute||(this._native?window.plugins.NativeAudio.play(this._sounds.path+t):!function(){var n=Date.now();e._players[n]=new Audio,e._players[n].src=e._sounds.path+t,e._players[n].addEventListener("ended",function(){return delete e._players[n]}),e._players[n].play()}())}},{key:"playEffect",value:function(t){var e=this._lastEffectNumbers[t];Number.isInteger(e)||(e=-1),e=(e+1)%this._sounds.effects[t].length,this._playSound(this._sounds.effects[t][e]),this._lastEffectNumbers[t]=e}},{key:"mute",value:function(){if(this._mute=!this._mute,this._native){var t=!0,e=!1,n=void 0;try{for(var i,r=this._nativeMusicIds[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var s=i.value;window.plugins.NativeAudio.setVolumeForComplexAsset(s,this._mute?0:1)}}catch(t){e=!0,n=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw n}}}else{this._musicPlayer.muted=this._mute;for(var o in this._players)this._players[o].muted=this._mute}}}]),e}(),B=4e-4,N=800,G="newStar",M="wrongStar",q=function(){function t(){var e=this;n(this,t),this._mistakesControl=new d(document.querySelector(".control_mistakes")),this._scoresControl=new c(document.querySelector(".control_scores")),this._soundControl=new _(document.querySelector(".control_sound")),this._soundEffects=new L(P,function(t){return e._soundControl.updateSongName(t)}),this._soundControl.muteCallback=function(){return e._soundEffects.mute()},this._stars=[],this._starsHolder=new C(document.querySelector(".stars-holder"));for(var i=document.body.clientWidth*document.body.clientHeight*B,r=0;r<=i;r++)this._addStar();this._menuScreenStart=new w(document.querySelector(".menu__screen_start")),this._menuScreenStart.startGameBtn.addEventListener("click",function(){e._startGame()}),this._menuScreenEnd=new O(document.querySelector(".menu__screen_end-game")),this._menuScreenEnd.retryBtn.addEventListener("click",function(){e._startGame()}),this._menuScreenEnd.shareBtn&&this._menuScreenEnd.shareBtn.addEventListener("click",function(){if(window.plugins&&window.plugins.socialsharing){var t={message:"I have counted "+e._scoresControl.value+" stars in Count The Stars Game!",subject:"Count The Stars",url:"http://mad-gooze.github.io/CountTheStarsGame/"};window.plugins.socialsharing.shareWithOptions(t)}}),this._soundControl.show(),this._menuScreenStart.show()}return i(t,[{key:"_addStar",value:function(t,e){var n=this,i=k.generateRandom();this._stars.push(i),i.addToDOM(this._starsHolder.node),setTimeout(i.show.bind(i),100),t&&i.addEventListener("click",function(){n._processStarClick(i)}),e&&this._soundEffects.playEffect(e)}},{key:"_processStarClick",value:function(t){var e=this._stars.indexOf(t);e==this._stars.length-1?(this._scoresControl.value++,this._addStar(!0,G)):(this._mistakesControl.value--,this._mistakesControl.value<0?(this._endGame(),this._soundEffects.playEffect(M)):this._addStar(!0,M))}},{key:"_endGame",value:function(){this._starsHolder.hide(),this._mistakesControl.hide(),this._scoresControl.hide(),this._menuScreenEnd.show(),this._menuScreenEnd.score=this._scoresControl.value}},{key:"_startGame",value:function(){var t=this;this._menuScreenStart.hide(),this._menuScreenEnd.hide();var e=!0,n=!1,i=void 0;try{for(var r,s=this._stars[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var o=r.value;o.hide()}}catch(t){n=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(n)throw i}}setTimeout(function(){var e=!0,n=!1,i=void 0;try{for(var r,s=t._stars[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var o=r.value;o.remove()}}catch(t){n=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(n)throw i}}t._stars=[],t._addStar(!0,G)},N),this._mistakesControl.dropValue(),this._scoresControl.dropValue(),this._mistakesControl.show(),this._scoresControl.show(),this._starsHolder.show()}}]),t}();document.addEventListener("deviceready",e,!1),window.onload=e}();
//# sourceMappingURL=App.js.map
